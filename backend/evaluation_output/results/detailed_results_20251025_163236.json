[
  {
    "test_case_id": 1,
    "test_case_name": "รายได้ 600K - ความเสี่ยงกลาง",
    "input": {
      "gross_income": 600000,
      "personal_deduction": 60000,
      "spouse_deduction": 0,
      "child_deduction": 0,
      "parent_support": 0,
      "disabled_support": 0,
      "life_insurance": 50000,
      "life_insurance_pension": 0,
      "life_insurance_parents": 0,
      "health_insurance": 15000,
      "health_insurance_parents": 0,
      "social_security": 9000,
      "pension_insurance": 0,
      "provident_fund": 50000,
      "gpf": 0,
      "pvd_teacher": 0,
      "rmf": 0,
      "thai_esg": 0,
      "thai_esgx_new": 0,
      "thai_esgx_ltf": 0,
      "stock_investment": 0,
      "easy_e_receipt": 0,
      "home_loan_interest": 0,
      "nsf": 0,
      "donation_general": 0,
      "donation_education": 0,
      "donation_social_enterprise": 0,
      "donation_political": 0,
      "risk_tolerance": "medium"
    },
    "tax_result": {
      "gross_income": 600000,
      "taxable_income": 416000,
      "tax_amount": 19100,
      "effective_tax_rate": 3.18
    },
    "ai_response": {
      "plans": [
        {
          "plan_id": "1",
          "plan_name": "ทางเลือกที่ 1 - เน้นประกัน",
          "plan_type": "medium",
          "description": "เน้นความคุ้มครอง เงินลงทุนพอเหมาะ",
          "total_investment": 150000,
          "total_tax_saving": 15000,
          "overall_risk": "medium",
          "allocations": [
            {
              "category": "ประกันชีวิต",
              "investment_amount": 50000,
              "percentage": 33.33,
              "tax_saving": 5000,
              "risk_level": "low",
              "pros": [
                "คุ้มครองชีวิต",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ผลตอบแทนต่ำ",
                "ต้องถือยาว"
              ]
            },
            {
              "category": "ประกันบำนาญ",
              "investment_amount": 50000,
              "percentage": 33.33,
              "tax_saving": 5000,
              "risk_level": "low",
              "pros": [
                "มีรายได้หลังเกษียณ",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ต้องถือยาว",
                "ผลตอบแทนคงที่"
              ]
            },
            {
              "category": "ประกันสุขภาพ",
              "investment_amount": 50000,
              "percentage": 33.33,
              "tax_saving": 5000,
              "risk_level": "low",
              "pros": [
                "คุ้มครองค่ารักษาพยาบาล",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ค่าเบี้ยสูง",
                "ไม่คืนเงินถ้าไม่เคลม"
              ]
            }
          ]
        },
        {
          "plan_id": "2",
          "plan_name": "ทางเลือกที่ 2 - สมดุล",
          "plan_type": "medium",
          "description": "กระจายความเสี่ยง เน้น RMF + ThaiESG",
          "total_investment": 225000,
          "total_tax_saving": 22500,
          "overall_risk": "medium",
          "allocations": [
            {
              "category": "RMF",
              "investment_amount": 100000,
              "percentage": 44.44,
              "tax_saving": 10000,
              "risk_level": "medium",
              "pros": [
                "ลดหย่อนภาษีได้สูง",
                "การลงทุนระยะยาว"
              ],
              "cons": [
                "ต้องถือจนอายุ 55 ปี",
                "ความเสี่ยงจากตลาด"
              ]
            },
            {
              "category": "ThaiESG",
              "investment_amount": 75000,
              "percentage": 33.33,
              "tax_saving": 7500,
              "risk_level": "medium",
              "pros": [
                "สนับสนุนธุรกิจยั่งยืน",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ความเสี่ยงจากตลาด",
                "ต้องถือ 8 ปีขึ้นไป"
              ]
            },
            {
              "category": "ประกันชีวิต",
              "investment_amount": 50000,
              "percentage": 22.22,
              "tax_saving": 5000,
              "risk_level": "low",
              "pros": [
                "คุ้มครองชีวิต",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ผลตอบแทนต่ำ",
                "ต้องถือยาว"
              ]
            }
          ]
        },
        {
          "plan_id": "3",
          "plan_name": "ทางเลือกที่ 3 - ลงทุนสูงสุด",
          "plan_type": "medium",
          "description": "เน้นลดหย่อนภาษีสูงสุด ใช้วงเงินเต็มที่",
          "total_investment": 300000,
          "total_tax_saving": 30000,
          "overall_risk": "medium",
          "allocations": [
            {
              "category": "RMF",
              "investment_amount": 100000,
              "percentage": 33.33,
              "tax_saving": 10000,
              "risk_level": "medium",
              "pros": [
                "ลดหย่อนภาษีได้สูง",
                "การลงทุนระยะยาว"
              ],
              "cons": [
                "ต้องถือจนอายุ 55 ปี",
                "ความเสี่ยงจากตลาด"
              ]
            },
            {
              "category": "ThaiESG",
              "investment_amount": 100000,
              "percentage": 33.33,
              "tax_saving": 10000,
              "risk_level": "medium",
              "pros": [
                "สนับสนุนธุรกิจยั่งยืน",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ความเสี่ยงจากตลาด",
                "ต้องถือ 8 ปีขึ้นไป"
              ]
            },
            {
              "category": "ThaiESGX",
              "investment_amount": 100000,
              "percentage": 33.33,
              "tax_saving": 10000,
              "risk_level": "medium",
              "pros": [
                "สนับสนุนธุรกิจยั่งยืน",
                "ลดหย่อนภาษีได้"
              ],
              "cons": [
                "ความเสี่ยงจากตลาด",
                "ต้องถือ 8 ปีขึ้นไป"
              ]
            }
          ]
        }
      ]
    },
    "expected_plans": {
      "plan_1": {
        "plan_id": "1",
        "plan_name": "ทางเลือกที่ 1 - เน้นประกัน",
        "plan_type": "medium",
        "description": "เน้นความคุ้มครองและความปลอดภัย เหมาะกับผู้เริ่มต้นวางแผนภาษี",
        "total_investment": 60000,
        "total_tax_saving": 3000,
        "overall_risk": "medium",
        "allocations": [
          {
            "category": "ประกันชีวิตเพิ่มเติม",
            "investment_amount": 20000,
            "percentage": 33.33,
            "tax_saving": 1000,
            "risk_level": "low",
            "pros": [
              "มีความคุ้มครอง",
              "จำเป็นสำหรับครอบครัว"
            ],
            "cons": [
              "ผลตอบแทนต่ำ"
            ]
          },
          {
            "category": "RMF",
            "investment_amount": 30000,
            "percentage": 50.0,
            "tax_saving": 1500,
            "risk_level": "medium",
            "pros": [
              "ลดหย่อนภาษีได้",
              "ผลตอบแทนดี"
            ],
            "cons": [
              "ต้องถือ 5 ปี"
            ]
          },
          {
            "category": "ประกันสุขภาพเพิ่มเติม",
            "investment_amount": 10000,
            "percentage": 16.67,
            "tax_saving": 500,
            "risk_level": "low",
            "pros": [
              "คุ้มครองสุขภาพ"
            ],
            "cons": [
              "ไม่มีผลตอบแทน"
            ]
          }
        ]
      },
      "plan_2": {
        "plan_id": "2",
        "plan_name": "ทางเลือกที่ 2 - สมดุล",
        "plan_type": "medium",
        "description": "กระจายความเสี่ยง เน้น RMF และกองทุน ESG",
        "total_investment": 100000,
        "total_tax_saving": 5000,
        "overall_risk": "medium",
        "allocations": [
          {
            "category": "RMF",
            "investment_amount": 60000,
            "percentage": 60.0,
            "tax_saving": 3000,
            "risk_level": "medium",
            "pros": [
              "ลดหย่อนภาษี 30%",
              "ผลตอบแทนดี"
            ],
            "cons": [
              "ต้องถือ 5 ปี"
            ]
          },
          {
            "category": "ThaiESG",
            "investment_amount": 30000,
            "percentage": 30.0,
            "tax_saving": 1500,
            "risk_level": "medium",
            "pros": [
              "ลดหย่อน 30%",
              "ลงทุนยั่งยืน"
            ],
            "cons": [
              "ต้องถือ 8 ปี"
            ]
          },
          {
            "category": "ประกันบำนาญ",
            "investment_amount": 10000,
            "percentage": 10.0,
            "tax_saving": 500,
            "risk_level": "low",
            "pros": [
              "รับประกันผลตอบแทน"
            ],
            "cons": [
              "ผูกพันระยะยาว"
            ]
          }
        ]
      },
      "plan_3": {
        "plan_id": "3",
        "plan_name": "ทางเลือกที่ 3 - เติบโตสูงสุด",
        "plan_type": "medium",
        "description": "ใช้วงเงินลดหย่อนสูงสุด เน้นการลงทุนระยะยาว",
        "total_investment": 150000,
        "total_tax_saving": 7500,
        "overall_risk": "medium",
        "allocations": [
          {
            "category": "RMF",
            "investment_amount": 90000,
            "percentage": 60.0,
            "tax_saving": 4500,
            "risk_level": "medium",
            "pros": [
              "ลดหย่อนสูง",
              "ผลตอบแทนดี"
            ],
            "cons": [
              "ต้องถือจนอายุ 55"
            ]
          },
          {
            "category": "ThaiESG",
            "investment_amount": 40000,
            "percentage": 26.67,
            "tax_saving": 2000,
            "risk_level": "medium",
            "pros": [
              "ลดหย่อน 30%",
              "ESG"
            ],
            "cons": [
              "ต้องถือ 8 ปี"
            ]
          },
          {
            "category": "ประกันบำนาญ",
            "investment_amount": 20000,
            "percentage": 13.33,
            "tax_saving": 1000,
            "risk_level": "low",
            "pros": [
              "รับประกันผลตอบแทน",
              "เหมาะเกษียณ"
            ],
            "cons": [
              "ผูกพันยาว"
            ]
          }
        ]
      }
    },
    "evaluation_results": {
      "overall_metrics": {
        "expected_plan_count": 3,
        "actual_plan_count": 3,
        "has_all_plans": true,
        "text_metrics": {
          "avg_rouge1_precision": 0.8888888888888888,
          "avg_rouge1_recall": 0.8888888888888888,
          "avg_rouge1_f1": 0.8888888888888888,
          "avg_rouge2_precision": 0.0,
          "avg_rouge2_recall": 0.0,
          "avg_rouge2_f1": 0.0,
          "avg_rougeL_precision": 0.8888888888888888,
          "avg_rougeL_recall": 0.8888888888888888,
          "avg_rougeL_f1": 0.8888888888888888,
          "avg_bleu1": 0.7878824124942961,
          "avg_bleu2": 0.6931673984209193,
          "avg_bleu3": 0.6280266027756604,
          "avg_bleu4": 0.5751525240731392,
          "avg_avg_allocation_text_similarity": 0.4444444444444444
        },
        "avg_numeric_accuracy": 0.0
      },
      "plan_metrics": {
        "plan_1": {
          "text_metrics": {
            "rouge1_precision": 1.0,
            "rouge1_recall": 1.0,
            "rouge1_f1": 1.0,
            "rouge2_precision": 0.0,
            "rouge2_recall": 0.0,
            "rouge2_f1": 0.0,
            "rougeL_precision": 1.0,
            "rougeL_recall": 1.0,
            "rougeL_f1": 1.0,
            "bleu1": 0.6814506851874793,
            "bleu2": 0.6238513498013287,
            "bleu3": 0.5814552337042198,
            "bleu4": 0.5346518078557698,
            "avg_allocation_text_similarity": 0.0
          },
          "numeric_metrics": {
            "total_investment": {
              "expected": 60000,
              "actual": 150000,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 150.0
            },
            "total_tax_saving": {
              "expected": 3000,
              "actual": 15000,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 400.0
            }
          },
          "structural_metrics": {
            "expected_allocation_count": 3,
            "actual_allocation_count": 3,
            "has_correct_structure": true
          },
          "allocation_metrics": {
            "individual_scores": [
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": false
              },
              {
                "investment_accuracy": 33.333333333333336,
                "tax_saving_accuracy": 0,
                "category_match": false
              },
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": false
              }
            ],
            "average_investment_accuracy": 11.111111111111112,
            "average_tax_saving_accuracy": 0.0
          }
        },
        "plan_2": {
          "text_metrics": {
            "rouge1_precision": 0.6666666666666666,
            "rouge1_recall": 0.6666666666666666,
            "rouge1_f1": 0.6666666666666666,
            "rouge2_precision": 0.0,
            "rouge2_recall": 0.0,
            "rouge2_f1": 0.0,
            "rougeL_precision": 0.6666666666666666,
            "rougeL_recall": 0.6666666666666666,
            "rougeL_f1": 0.6666666666666666,
            "bleu1": 0.8488632189620754,
            "bleu2": 0.7914396813063577,
            "bleu3": 0.7503533808334887,
            "bleu4": 0.7062089121690315,
            "avg_allocation_text_similarity": 0.6666666666666666
          },
          "numeric_metrics": {
            "total_investment": {
              "expected": 100000,
              "actual": 225000,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 125.0
            },
            "total_tax_saving": {
              "expected": 5000,
              "actual": 22500,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 350.0
            }
          },
          "structural_metrics": {
            "expected_allocation_count": 3,
            "actual_allocation_count": 3,
            "has_correct_structure": true
          },
          "allocation_metrics": {
            "individual_scores": [
              {
                "investment_accuracy": 33.333333333333336,
                "tax_saving_accuracy": 0,
                "category_match": true
              },
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": true
              },
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": false
              }
            ],
            "average_investment_accuracy": 11.111111111111112,
            "average_tax_saving_accuracy": 0.0
          }
        },
        "plan_3": {
          "text_metrics": {
            "rouge1_precision": 1.0,
            "rouge1_recall": 1.0,
            "rouge1_f1": 1.0,
            "rouge2_precision": 0.0,
            "rouge2_recall": 0.0,
            "rouge2_f1": 0.0,
            "rougeL_precision": 1.0,
            "rougeL_recall": 1.0,
            "rougeL_f1": 1.0,
            "bleu1": 0.8333333333333334,
            "bleu2": 0.6642111641550715,
            "bleu3": 0.5522711937892727,
            "bleu4": 0.48459685219461657,
            "avg_allocation_text_similarity": 0.6666666666666666
          },
          "numeric_metrics": {
            "total_investment": {
              "expected": 150000,
              "actual": 300000,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 100.0
            },
            "total_tax_saving": {
              "expected": 7500,
              "actual": 30000,
              "accuracy": 0,
              "within_tolerance": false,
              "error_percentage": 300.0
            }
          },
          "structural_metrics": {
            "expected_allocation_count": 3,
            "actual_allocation_count": 3,
            "has_correct_structure": true
          },
          "allocation_metrics": {
            "individual_scores": [
              {
                "investment_accuracy": 88.88888888888889,
                "tax_saving_accuracy": 0,
                "category_match": true
              },
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": true
              },
              {
                "investment_accuracy": 0,
                "tax_saving_accuracy": 0,
                "category_match": false
              }
            ],
            "average_investment_accuracy": 29.62962962962963,
            "average_tax_saving_accuracy": 0.0
          }
        }
      }
    },
    "raw_response_preview": "```json\n{\n  \"plans\": [\n    {\n      \"plan_id\": \"1\",\n      \"plan_name\": \"ทางเลือกที่ 1 - เน้นประกัน\",\n      \"plan_type\": \"medium\",\n      \"description\": \"เน้นความคุ้มครอง เงินลงทุนพอเหมาะ\",\n      \"total_investment\": 150000,\n      \"total_tax_saving\": 15000,\n      \"overall_risk\": \"medium\",\n      \"allocat"
  }
]